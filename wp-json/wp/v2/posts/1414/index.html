{"id":1414,"date":"2024-01-24T03:05:08","date_gmt":"2024-01-24T03:05:08","guid":{"rendered":"https:\/\/malwr0nwind0z.com\/?p=1414"},"modified":"2024-01-26T00:32:47","modified_gmt":"2024-01-26T00:32:47","slug":"post_1-23-24_lockbit_ransomware_3-0","status":"publish","type":"post","link":"https:\/\/malwr0nwind0z.com\/post_1-23-24_lockbit_ransomware_3-0\/","title":{"rendered":"Lockbit Ransomware 3.0 leverages malicious Word Documents"},"content":{"rendered":"\n<figure class=\"wp-block-embed is-type-video is-provider-youtube wp-block-embed-youtube wp-embed-aspect-16-9 wp-has-aspect-ratio\"><div class=\"wp-block-embed__wrapper\">\n<div class=\"ast-oembed-container \" style=\"height: 100%;\"><iframe title=\"Lockbit Ransomware 3.0 leverages malicious Word Documents\" width=\"500\" height=\"281\" src=\"https:\/\/www.youtube.com\/embed\/X3ngD7lI35Q?feature=oembed\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" allowfullscreen><\/iframe><\/div>\n<\/div><figcaption class=\"wp-element-caption\"><strong>Video 1: Watch the companion video that this blog post inspired.<\/strong><\/figcaption><\/figure>\n\n\n<p><strong>Lockbit Ransomware<\/strong><\/p>\n<p>Lockbit is a well-known ransomware-as-a-service (RAAS) that first emerged in 2019. The Lockbit group threat actors or RAAS affiliates first target a system, once this system is compromised. Its file system is encrypted and a ransom note is dropped on the victim\u2019s computer. This note contains instructions on how to make the ransom payment.<\/p>\n<p>Lockbit operators are known to engage in a double-extortion tactic. This involves not only encrypting the files but also exfiltrating sensitive data before encryption. The Lockbit operators then threaten to leak the victim\u2019s data unless the ransom is paid.<\/p>\n<p><strong>How this Lockbit Ransomware works<\/strong><\/p>\n<p>Lockbit ransomware is typically delivered (attack vectors) to the victim through various methods: phishing emails, malicious spam (malspam), software vulnerabilities, RDP exploitation, and post exploitation kits.<\/p>\n<p>During this particular ransomware campaign, the ransomware was distributed to unsuspecting victims.\u00a0They were tricked into opening a malicious Microsoft Word document named werili.docx. This malicious Word document contained the following social engineering images: \u201cSelect Enable Editing\u201d and \u201cSelect Enable Content\u201d (Figure 1), that enticed the unaware victim into enabling editing which then executed the embedded VBA macros, resulting in the encryption of the victim\u2019s computer.<\/p>\n<p><img fetchpriority=\"high\" decoding=\"async\" width=\"1346\" height=\"707\" class=\"wp-image-1416\" src=\"http:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-description-automatica.png\" alt=\"A screenshot of a computer\n\nDescription automatically generated\" srcset=\"https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-description-automatica.png 1346w, https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-description-automatica-300x158.png 300w, https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-description-automatica-1024x538.png 1024w, https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-description-automatica-768x403.png 768w\" sizes=\"(max-width: 1346px) 100vw, 1346px\" \/><em>Figure 1: <\/em>Word document contained social engineering images: \u201cEnable Editing\u201d and \u201cSelect Enable Content\u201d, that goaded the unaware victims into enabling editing which then executed the embedded VBA macros.<\/p>\n<p><strong>Analysis of the Stage 1 loader \u2013 werili.docx<\/strong><\/p>\n<p>All office document files (i.e. docx, xlsx and pptx) are archive files. Meaning that you can change the extension to .zip and unzip it or it can be directly opened via tools like Winzip or 7zip to extract the contents of these files.<\/p>\n<p>Threat actors often abuse the pre-built file templates called\u00a0.\/word_rels\/settings.xml.rels\u00a0or\u00a0.\/word\/_rels\/settings.xml.rels (Figure 2). These templates are created within the office document files and normally contain the remote or local path to another template with the extension\u00a0.dotm\u00a0that will be automatically loaded upon opening the document.<\/p>\n<p><img decoding=\"async\" width=\"1366\" height=\"88\" class=\"wp-image-1417\" src=\"http:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/word-image-1414-2.png\" srcset=\"https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/word-image-1414-2.png 1366w, https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/word-image-1414-2-300x19.png 300w, https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/word-image-1414-2-1024x66.png 1024w, https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/word-image-1414-2-768x49.png 768w\" sizes=\"(max-width: 1366px) 100vw, 1366px\" \/><em>Figure 2: settings.xml.rels showed the target url that is hosting the template .dotm file.<\/em><\/p>\n<p>After further review, I can see that the threat actors decompress the .docx file and change the\u00a0<em>Target<\/em>\u00a0value in the\u00a0<em>settings.xml.rels<\/em>\u00a0file to load their desired template and again compressed it to a .docx file.<\/p>\n<p>Please, note that Target does not need to be local, it can be remote as well, in this case we can see a URL in Target value i.e. \u201cTarget=&amp;#x68ttps[:]\/\/learndash[.]825testsites[.]com\/b\/fgi5k8.dotm\u201d<em>(<\/em>&amp;#x68 converts to h<em>).<\/em><\/p>\n<p>We have two office document files: \u201cwerili.docx\u201d and \u201cfgi5k8.dotm\u201d (template file). As the victim opens werili.docx it will download the template file (fgi5k8.dotm) along with its macros and as a result the macros will be automatically executed (Figure 3).<\/p>\n<p><img decoding=\"async\" width=\"802\" height=\"614\" class=\"wp-image-1418\" src=\"http:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-description-automatica-1.png\" alt=\"A screenshot of a computer\n\nDescription automatically generated\" srcset=\"https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-description-automatica-1.png 802w, https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-description-automatica-1-300x230.png 300w, https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-description-automatica-1-768x588.png 768w\" sizes=\"(max-width: 802px) 100vw, 802px\" \/><br \/><em>Figure 3: <\/em>werili.docx<em> downloading the template dotm file (<\/em>fgi5k8.dotm<em>) along with its macros and as a result the macros will get executed.<\/em><\/p>\n<p><strong>Analysis of the Stage 2 loader \u2013 fgi5k8.dotm<\/strong><\/p>\n<p>I utilized Microsoft Word\u2019s Developer Tools to analyze the embedded VB macros from the downloaded fgi5k8.dotm file. A quick review of the VB macro after loading it I could see that it was obfuscated. So, to save time I decided to dynamically open and run the malicious Word document in debugger mode (Figure 4 &amp; 5), then let CMD Watcher v0.3 capture (Figure 6) the malicious PowerShell script. Just from my past experience, I knew that the VB macros would ultimately invoke a PowerShell.<\/p>\n<p><img loading=\"lazy\" decoding=\"async\" width=\"1366\" height=\"768\" class=\"wp-image-1419\" src=\"http:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-computer-screen-with-a-white-screen-description.png\" alt=\"A computer screen with a white screen\n\nDescription automatically generated\" srcset=\"https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-computer-screen-with-a-white-screen-description.png 1366w, https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-computer-screen-with-a-white-screen-description-300x169.png 300w, https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-computer-screen-with-a-white-screen-description-1024x576.png 1024w, https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-computer-screen-with-a-white-screen-description-768x432.png 768w\" sizes=\"(max-width: 1366px) 100vw, 1366px\" \/><em>Figure 4: <\/em>fgi5k8.dotm\u2019s VB<em> macros executed upon opening.<\/em><\/p>\n<p><img loading=\"lazy\" decoding=\"async\" width=\"1166\" height=\"729\" class=\"wp-image-1420\" src=\"http:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-computer-screen-shot-of-a-computer-description.png\" alt=\"A computer screen shot of a computer\n\nDescription automatically generated\" srcset=\"https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-computer-screen-shot-of-a-computer-description.png 1166w, https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-computer-screen-shot-of-a-computer-description-300x188.png 300w, https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-computer-screen-shot-of-a-computer-description-1024x640.png 1024w, https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-computer-screen-shot-of-a-computer-description-768x480.png 768w\" sizes=\"(max-width: 1166px) 100vw, 1166px\" \/><em style=\"font-size: 1rem; color: var(--ast-global-color-3); background-color: var(--ast-global-color-5);\">Figure 5: <\/em><span style=\"font-size: 1rem; color: var(--ast-global-color-3); background-color: var(--ast-global-color-5);\">fgi5k8.dotm\u2019s VB<\/span><em style=\"font-size: 1rem; color: var(--ast-global-color-3); background-color: var(--ast-global-color-5);\"> macros are obfuscated. I used Word\u2019s Developer Tools to deobfuscate them.<\/em><\/p>\n<p><img loading=\"lazy\" decoding=\"async\" width=\"755\" height=\"424\" class=\"wp-image-1421\" src=\"http:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-program-description-au.png\" alt=\"A screenshot of a computer program\n\nDescription automatically generated\" srcset=\"https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-program-description-au.png 755w, https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-program-description-au-300x168.png 300w\" sizes=\"(max-width: 755px) 100vw, 755px\" \/><br \/><em>Figure 6: CMD Watcher v0.3 captured a snapshot of the malicious PowerShell script.<\/em><\/p>\n<p>After the VBA macros were executed a malicious PowerShell command was run. The PowerShell script utilized curl to download Lockbit payload from:<\/p>\n<p>https[:]\/\/learndash[.]825testsites[.]com\/b\/abc.exe<\/p>\n<p>The downloaded Lockbit payload\u2019s drop folder location (Figure 7):<\/p>\n<p>C:\\Users\\Public\\cw3fd.exe (Classification: Lockbit payload; abc.exe is renamed once dropped to disk: cw3fd.exe).<\/p>\n<p><img loading=\"lazy\" decoding=\"async\" width=\"661\" height=\"288\" class=\"wp-image-1422\" src=\"http:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-description-automatica-2.png\" alt=\"A screenshot of a computer\n\nDescription automatically generated\" srcset=\"https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-description-automatica-2.png 661w, https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-description-automatica-2-300x131.png 300w\" sizes=\"(max-width: 661px) 100vw, 661px\" \/><br \/><em style=\"font-size: 1rem; color: var(--ast-global-color-3); background-color: var(--ast-global-color-5);\">Figure 7: <\/em><span style=\"font-size: 1rem; color: var(--ast-global-color-3); background-color: var(--ast-global-color-5);\">Downloaded Lockbit payload\u2019s drop folder location<\/span><em style=\"font-size: 1rem; color: var(--ast-global-color-3); background-color: var(--ast-global-color-5);\">.<\/em><\/p>\n<p><strong>Analysis of the Stage 3 payload \u2013 cw3fd.exe<\/strong><\/p>\n<p>After the Lockbit payload was dropped on the system, it ran and encrypted the victim\u2019s file system. This variant is Lockbit 3.0, every encrypted file has a .ONa9v7hKI file extension (Figure 8) appended to the filename. Lockbit even changes the victim\u2019s desktop wallpaper letting them know that they have been encrypted (Figure 10).<\/p>\n<p><img loading=\"lazy\" decoding=\"async\" width=\"652\" height=\"405\" class=\"wp-image-1423\" src=\"http:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-description-automatica-3.png\" alt=\"A screenshot of a computer\n\nDescription automatically generated\" srcset=\"https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-description-automatica-3.png 652w, https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-description-automatica-3-300x186.png 300w\" sizes=\"(max-width: 652px) 100vw, 652px\" \/><br \/><em style=\"font-size: 1rem; color: var(--ast-global-color-3); background-color: var(--ast-global-color-5);\">Figure 8<\/em><span style=\"font-size: 1rem; color: var(--ast-global-color-3); background-color: var(--ast-global-color-5);\">: Lockbit encrypted the user\u2019s files and appended a .ONa9v7hKI file extension to the filename.<\/span><\/p>\n<p><img loading=\"lazy\" decoding=\"async\" width=\"1366\" height=\"703\" class=\"wp-image-1424\" src=\"http:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-description-automatica-4.png\" alt=\"A screenshot of a computer\n\nDescription automatically generated\" srcset=\"https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-description-automatica-4.png 1366w, https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-description-automatica-4-300x154.png 300w, https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-description-automatica-4-1024x527.png 1024w, https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-description-automatica-4-768x395.png 768w\" sizes=\"(max-width: 1366px) 100vw, 1366px\" \/><em>Figure 9: <\/em>This ransom note (ONa9v7hKI.READ.txt) was dropped in every directory.<\/p>\n<p><img loading=\"lazy\" decoding=\"async\" width=\"811\" height=\"314\" class=\"wp-image-1425\" src=\"http:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-black-screen-with-white-text-description-automa.png\" alt=\"A black screen with white text\n\nDescription automatically generated\" srcset=\"https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-black-screen-with-white-text-description-automa.png 811w, https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-black-screen-with-white-text-description-automa-300x116.png 300w, https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-black-screen-with-white-text-description-automa-768x297.png 768w\" sizes=\"(max-width: 811px) 100vw, 811px\" \/><br \/><em style=\"font-size: 1rem; color: var(--ast-global-color-3); background-color: var(--ast-global-color-5);\">Figure 10: <\/em><span style=\"font-size: 1rem; color: var(--ast-global-color-3); background-color: var(--ast-global-color-5);\">Lockbit\u2019s desktop wallpaper message to the victim.<\/span><\/p>\n<p>A standard practice by many ransomware variant is to delete shadow copies. Lockbit does this as well, in order to prevent the recovery of encrypted files from shadow copies, Lockbit 3.0 terminates and deletes the VSS service (Figure 11).<\/p>\n<p>Also, it disabled both Windows Service Center Service (Figure 12) and Windows Defender ATP Service (Figure 13), as well.<\/p>\n<p><img loading=\"lazy\" decoding=\"async\" width=\"369\" height=\"135\" class=\"wp-image-1426\" src=\"http:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-error-description-auto.png\" alt=\"A screenshot of a computer error\n\nDescription automatically generated\" srcset=\"https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-error-description-auto.png 369w, https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-error-description-auto-300x110.png 300w\" sizes=\"(max-width: 369px) 100vw, 369px\" \/><br \/><em>Figure 11: Process Hacker captured <\/em>Lockbit deletion of the VSS (Volume Shadow Copy) Service.<\/p>\n<p><img loading=\"lazy\" decoding=\"async\" width=\"371\" height=\"157\" class=\"wp-image-1427\" src=\"http:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screen-shot-of-a-computer-description-automatic.png\" alt=\"A screen shot of a computer\n\nDescription automatically generated\" srcset=\"https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screen-shot-of-a-computer-description-automatic.png 371w, https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screen-shot-of-a-computer-description-automatic-300x127.png 300w\" sizes=\"(max-width: 371px) 100vw, 371px\" \/><br \/><em>Figure 12: Process Hacker captured <\/em>Lockbit deletion of the Windows Security Center Service.<\/p>\n<p><img loading=\"lazy\" decoding=\"async\" width=\"369\" height=\"154\" class=\"wp-image-1428\" src=\"http:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-error-description-auto-1.png\" alt=\"A screenshot of a computer error\n\nDescription automatically generated\" srcset=\"https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-error-description-auto-1.png 369w, https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-error-description-auto-1-300x125.png 300w\" sizes=\"(max-width: 369px) 100vw, 369px\" \/><br \/><em>Figure 13: Process Hacker captured <\/em>Lockbit deletion of the Windows Defender ATP Service.<\/p>\n<p>Next, I started reviewing the code of cw3fd.exe, after looking at the strings using Bintext (Figure 14), this file was heavily obfuscated within each of the functions. This was definitely a packed file.<\/p>\n<p><img loading=\"lazy\" decoding=\"async\" width=\"1362\" height=\"730\" class=\"wp-image-1429\" src=\"http:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-description-automatica-5.png\" alt=\"A screenshot of a computer\n\nDescription automatically generated\" srcset=\"https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-description-automatica-5.png 1362w, https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-description-automatica-5-300x161.png 300w, https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-description-automatica-5-1024x549.png 1024w, https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-description-automatica-5-768x412.png 768w\" sizes=\"(max-width: 1362px) 100vw, 1362px\" \/><em>Figure 14: <\/em>Review of strings using Bintext revealed this file was heavily obfuscated.<\/p>\n<p>The next step was to look for the file\u2019s unpacking routine using IDA Pro, which brought attention to the use of VirtualAlloc which is used by malware to allocate memory when it is ready to unpack itself into memory. The appropriate breakpoints were set and the file was able to be dumped. Review of contents in the Dump Window, showed the binary was an executable (File header: MZ) (Figure 15).<\/p>\n<p><img loading=\"lazy\" decoding=\"async\" width=\"1364\" height=\"730\" class=\"wp-image-1430\" src=\"http:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-description-automatica-6.png\" alt=\"A screenshot of a computer\n\nDescription automatically generated\" srcset=\"https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-description-automatica-6.png 1364w, https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-description-automatica-6-300x161.png 300w, https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-description-automatica-6-1024x548.png 1024w, https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-description-automatica-6-768x411.png 768w\" sizes=\"(max-width: 1364px) 100vw, 1364px\" \/><em>Figure 15: <\/em>Review of contents in the Dump Window, showed the binary was an executable.<\/p>\n<p>The Lockbit binary is now unpacked, it is known for its dynamic API resolution at runtime which makes reverse engineering the sample more difficult and helps conceal functions from debuggers (Figure 16).<\/p>\n<p><img loading=\"lazy\" decoding=\"async\" width=\"1091\" height=\"450\" class=\"wp-image-1431\" src=\"http:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-description-automatica-7.png\" alt=\"A screenshot of a computer\n\nDescription automatically generated\" srcset=\"https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-description-automatica-7.png 1091w, https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-description-automatica-7-300x124.png 300w, https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-description-automatica-7-1024x422.png 1024w, https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-description-automatica-7-768x317.png 768w\" sizes=\"(max-width: 1091px) 100vw, 1091px\" \/><em>Figure 16: This function dynamically resolves the APIs at runtime<\/em>.<\/p>\n<p>As mentioned earlier, Lockbit dropped a ransom note in every directory. The function builds the ransom note is shown below (Figure 17).<\/p>\n<p><img loading=\"lazy\" decoding=\"async\" width=\"1092\" height=\"445\" class=\"wp-image-1432\" src=\"http:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-description-automatica-8.png\" alt=\"A screenshot of a computer\n\nDescription automatically generated\" srcset=\"https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-description-automatica-8.png 1092w, https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-description-automatica-8-300x122.png 300w, https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-description-automatica-8-1024x417.png 1024w, https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-description-automatica-8-768x313.png 768w\" sizes=\"(max-width: 1092px) 100vw, 1092px\" \/><em>Figure 17: <\/em>The function that builds the ransom note.<\/p>\n<p>Lockbit is also known for its string obfuscation. The following function is a Base64 decoding function used to decode strings (Figure 18).<\/p>\n<p><img loading=\"lazy\" decoding=\"async\" width=\"1049\" height=\"448\" class=\"wp-image-1433\" src=\"http:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-description-automatica-9.png\" alt=\"A screenshot of a computer\n\nDescription automatically generated\" srcset=\"https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-description-automatica-9.png 1049w, https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-description-automatica-9-300x128.png 300w, https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-description-automatica-9-1024x437.png 1024w, https:\/\/malwr0nwind0z.com\/wp-content\/uploads\/2024\/01\/a-screenshot-of-a-computer-description-automatica-9-768x328.png 768w\" sizes=\"(max-width: 1049px) 100vw, 1049px\" \/><em>Figure 18: <\/em>Base64 decoding function.<\/p>\n<p>Lockbit is a ransomware that can compromise the security of a target system and then it encrypts the file system. To protect against Lockbit ransomware attacks, it is important to be aware of the signs of infection and implement best practices for cybersecurity. Organizations should implement a backup strategy that keeps backups offline, not connected to your network and if possible offsite in a different location. By staying informed and vigilant, organizations and individuals can reduce their risk of falling victim to Lockbit.<\/p>\n<p><strong>IOCs:<\/strong><\/p>\n<p>werili.docx (MD5: 244e475d884c455bb1fbad1a4294f21c); Classification: Lockbit Loader<\/p>\n<p>fgi5k8.dotm (MD5: f2a9bc0e23f6ad044cb7c835826fa8fe) Classification: Lockbit Loader<\/p>\n<p>cw3fd.exe (MD5: 7a83a738db05418c0ae6795b317a45f9) Classification: Lockbit payload<\/p>\n<p>.ONa9v7hKI (Encrypted extension name)<\/p>\n<p>ONa9v7hKI.README.txt (Ransom note file name)<\/p>\n<p><strong>Network IOCs:<\/strong><\/p>\n<p>https[:]\/\/learndash[.]825testsites[.]com<\/p>\n<p>http[:]\/\/lockbitapt[xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx].onion (ONION domain ([46 random characters]))<\/p>\n<p>http[:]\/\/lockbitapt[xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx].onion.ly (ONION domain ([46 random characters]))<\/p>","protected":false},"excerpt":{"rendered":"<p>Lockbit Ransomware Lockbit is a well-known ransomware-as-a-service (RAAS) that first emerged in 2019. The Lockbit group threat actors or RAAS affiliates first target a system, once this system is compromised. Its file system is encrypted and a ransom note is dropped on the victim\u2019s computer. This note contains instructions on how to make the ransom [&hellip;]<\/p>\n","protected":false},"author":1,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"om_disable_all_campaigns":false,"_monsterinsights_skip_tracking":false,"_monsterinsights_sitenote_active":false,"_monsterinsights_sitenote_note":"","_monsterinsights_sitenote_category":0,"site-sidebar-layout":"default","site-content-layout":"","ast-site-content-layout":"default","site-content-style":"default","site-sidebar-style":"default","ast-global-header-display":"","ast-banner-title-visibility":"","ast-main-header-display":"","ast-hfb-above-header-display":"","ast-hfb-below-header-display":"","ast-hfb-mobile-header-display":"","site-post-title":"","ast-breadcrumbs-content":"","ast-featured-img":"","footer-sml-layout":"","theme-transparent-header-meta":"","adv-header-id-meta":"","stick-header-meta":"","header-above-stick-meta":"","header-main-stick-meta":"","header-below-stick-meta":"","astra-migrate-meta-layouts":"set","ast-page-background-enabled":"default","ast-page-background-meta":{"desktop":{"background-color":"","background-image":"","background-repeat":"repeat","background-position":"center center","background-size":"auto","background-attachment":"scroll","background-type":"","background-media":"","overlay-type":"","overlay-color":"","overlay-gradient":""},"tablet":{"background-color":"","background-image":"","background-repeat":"repeat","background-position":"center center","background-size":"auto","background-attachment":"scroll","background-type":"","background-media":"","overlay-type":"","overlay-color":"","overlay-gradient":""},"mobile":{"background-color":"","background-image":"","background-repeat":"repeat","background-position":"center center","background-size":"auto","background-attachment":"scroll","background-type":"","background-media":"","overlay-type":"","overlay-color":"","overlay-gradient":""}},"ast-content-background-meta":{"desktop":{"background-color":"var(--ast-global-color-5)","background-image":"","background-repeat":"repeat","background-position":"center center","background-size":"auto","background-attachment":"scroll","background-type":"","background-media":"","overlay-type":"","overlay-color":"","overlay-gradient":""},"tablet":{"background-color":"var(--ast-global-color-5)","background-image":"","background-repeat":"repeat","background-position":"center center","background-size":"auto","background-attachment":"scroll","background-type":"","background-media":"","overlay-type":"","overlay-color":"","overlay-gradient":""},"mobile":{"background-color":"var(--ast-global-color-5)","background-image":"","background-repeat":"repeat","background-position":"center center","background-size":"auto","background-attachment":"scroll","background-type":"","background-media":"","overlay-type":"","overlay-color":"","overlay-gradient":""}},"footnotes":""},"categories":[4],"tags":[93,92,96,99,90,97,25,14,85,95,53,98,91,94],"aioseo_notices":[],"_links":{"self":[{"href":"https:\/\/malwr0nwind0z.com\/wp-json\/wp\/v2\/posts\/1414"}],"collection":[{"href":"https:\/\/malwr0nwind0z.com\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/malwr0nwind0z.com\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/malwr0nwind0z.com\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/malwr0nwind0z.com\/wp-json\/wp\/v2\/comments?post=1414"}],"version-history":[{"count":10,"href":"https:\/\/malwr0nwind0z.com\/wp-json\/wp\/v2\/posts\/1414\/revisions"}],"predecessor-version":[{"id":1450,"href":"https:\/\/malwr0nwind0z.com\/wp-json\/wp\/v2\/posts\/1414\/revisions\/1450"}],"wp:attachment":[{"href":"https:\/\/malwr0nwind0z.com\/wp-json\/wp\/v2\/media?parent=1414"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/malwr0nwind0z.com\/wp-json\/wp\/v2\/categories?post=1414"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/malwr0nwind0z.com\/wp-json\/wp\/v2\/tags?post=1414"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}